' Gambas class file

Static Public Function CreateWavFile(FileName As String, NotesFolder As String) As WavFile

  Dim Model As WavFile = WavFile.GetNewTemplate()
  Dim Text As String
  Dim Bar As String
  Dim Note As String
  Dim Gap As Byte

  Text = File.Load(FileName)

  For Each Bar In Split(Text, gb.NewLine)
    For Each Note In Split(Bar)
      Note = Trim(Note)
      If Note

        Gap = CByte(Right(Note, 1))
        Note = Left(Note, 2)
        Model.AppendWavFile(NotesFolder &/ Trim(Note) & ".wav")

      End If
    Next
    'sToPlay.Add("|")
  Next

  Return Model

End
