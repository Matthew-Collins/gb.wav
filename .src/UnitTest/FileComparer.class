' Gambas class file

Static Public Sub Compare(ActualFileName As String, ExpectedFileName As String)

  Dim DataFile1 As File
  Dim DataFile2 As File
  Dim Data1 As Byte
  Dim Data2 As Byte
  Dim Count As Integer

  DataFile1 = Open ActualFileName For Read
  DataFile2 = Open ExpectedFileName For Read

  Assert.Section = "Compare Files"
  Assert.Test = "File Size"
  Assert.IsExpected(Stat(ActualFileName).Size, Stat(ExpectedFileName).Size, "Files Different Sizes")

  Do While Not Eof(DataFile1) And Not Eof(DataFile2)
    Count += 1
    Read #DataFile1, Data1
    Read #DataFile2, Data2
    Assert.Test = "Byte Compare"
    Assert.Part = Count
    Assert.IsExpected(Data1, Data2, "Data Mismatch Found")
  Loop

End
